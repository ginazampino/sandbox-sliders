<!DOCTYPE html>
<html>

<head>
    <title>sandbox-swiper</title>
    <link href=" https://cdn.jsdelivr.net/npm/swiper@12.0.3/swiper-bundle.min.css " rel="stylesheet">
    <script src=" https://cdn.jsdelivr.net/npm/swiper@12.0.3/swiper-bundle.min.js "></script>
    <link rel="stylesheet" href="./style.css" />
</head>

<body>
    <main>
        <h1>Slider</h1>
        <div class="swiper-container">
            <div class="swiper">
                <div class="swiper-wrapper">
                    <div class="swiper-slide">Slide 1</div>
                    <div class="swiper-slide">Slide 2</div>
                    <div class="swiper-slide">Slide 3</div>
                    <div class="swiper-slide">Slide 4</div>
                    <div class="swiper-slide">Slide 5</div>
                    <div class="swiper-slide">Slide 6</div>
                </div>
            </div>
        </div>
    </main>
    <script>
        const container = document.querySelector('.swiper-container');
        const el = document.querySelector(".swiper");

        const swiper = new Swiper('.swiper', {
            slidesPerView: 'auto',
            spaceBetween: 20,
            allowTouchMove: false,
            speed: 0,
            loop: false
        });

        const wrapper = el.querySelector(".swiper-wrapper");

        // 1) Duplicate slides once
        const originalSlides = Array.from(wrapper.children);
        originalSlides.forEach((slide) => wrapper.appendChild(slide.cloneNode(true)));

        // 2) Measure the width of the ORIGINAL set (before duplicates)
        function measureLoopWidth() {
            // total width from first original slide start to last original slide end
            const first = originalSlides[0];
            const last = originalSlides[originalSlides.length - 1];

            const firstLeft = first.offsetLeft;
            const lastRight = last.offsetLeft + last.offsetWidth;

            return lastRight - firstLeft;
        }

        let loopWidth = 0;

        function recalc() {
            swiper.update();           // let Swiper recalc sizes
            loopWidth = measureLoopWidth();
        }

        // call once and on resize
        recalc();
        window.addEventListener("resize", recalc);

        // rAF ticker
        let rafId = 0;
        let lastTime = 0;
        let x = 0; // our own translate in px (negative = moving left)

        const PPS = 80; // px/sec

        function tick(t) {
            if (!lastTime) lastTime = t;
            const dt = (t - lastTime) / 1000;
            lastTime = t;

            x -= PPS * dt;

            // when we've moved past one full set, wrap around
            if (loopWidth > 0 && -x >= loopWidth) {
                x += loopWidth; // jump forward by exactly one set width (seamless)
            }

            swiper.setTransition(0);
            swiper.setTranslate(x);

            rafId = requestAnimationFrame(tick);
        }

        function play() {
            if (rafId) return;
            lastTime = 0;
            rafId = requestAnimationFrame(tick);
        }

        function pause() {
            cancelAnimationFrame(rafId);
            rafId = 0;
            lastTime = 0;
        }

        play();

        container.addEventListener("mouseenter", pause);
        container.addEventListener("mouseleave", play);


    </script>
</body>

</html>